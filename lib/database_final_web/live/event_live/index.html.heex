<%!--
<.header>
  Listing Events
  <:actions>
    <.link patch={~p"/events/new"}>
      <.button>New Event</.button>
    </.link>
  </:actions>
</.header>



<.modal :if={@live_action in [:new, :edit]} id="event-modal" show on_cancel={JS.patch(~p"/events")}>
  <.live_component
    module={DatabaseFinalWeb.EventLive.FormComponent}
    id={@event.id || :new}
    title={@page_title}
    action={@live_action}
    event={@event}
    patch={~p"/events"}
  />
</.modal>



<.table
  id="events"
  rows={@streams.events}
  row_click={fn {_id, event} -> JS.navigate(~p"/events/#{event}") end}
>
  <:col :let={{_id, event}} label="Sender"><%= event.sender %></:col>
  <:col :let={{_id, event}} label="Type"><%= event.type %></:col>
  <:col :let={{_id, event}} label="Payload"><%= event.payload %></:col>
  <:col :let={{_id, event}} label="Room"><%= event.room %></:col>
  <:action :let={{_id, event}}>
    <div class="sr-only">
      <.link navigate={~p"/events/#{event}"}>Show</.link>
    </div>
    <.link patch={~p"/events/#{event}/edit"}>Edit</.link>
  </:action>
  <:action :let={{id, event}}>
    <.link
      phx-click={JS.push("delete", value: %{id: event.id}) |> hide("##{id}")}
      data-confirm="Are you sure?"
    >
      Delete
    </.link>
  </:action>
</.table>

<div class="flex flex-col justify-start items-start rounded-md border shadow-md p-5">
<%= for {id, event} <- @streams.events do %>
  <.live_component module={DatabaseFinalWeb.EventLive.MessageBuble} event={event} id={id} />
<% end %>
</div>
--%>

<div
  class="flex flex-col items-start justify-start max-h-[600px] overflow-scroll"
  id="events"
  phx-update="stream"
>
  <div
    :for={{id, event} <- @streams.events}
    class="flex justify-center items-center"
    onclick="scrollToNewestEvent"
  >
    <img
      src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxISEhUSEhMVFRUXFRUVFhUWFRUVFRcVFRUXFhUVFRUYHSggGBolHRUVITEhJSkrLi4uFx8zODMsNygtLi0BCgoKDg0OGhAQGi0lHx8vLS0tLS0vLS0uLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0vLS0tLS0tLS0tLi0tLf/AABEIAQkAvgMBIgACEQEDEQH/xAAcAAACAgMBAQAAAAAAAAAAAAAEBQMGAQIHAAj/xABBEAACAgADBAYHBQYGAgMAAAABAgADBBEhBRIxQQYTUWFxgSIyUpGhsdEHFEJiwSMzU3KSk1SCorLS8MLhY3Px/8QAGQEAAwEBAQAAAAAAAAAAAAAAAQIDBAAF/8QAMBEAAgIBBAAEBAUEAwAAAAAAAAECEQMEEiExE0FRYQUigdEyQpGh8BRxseFicsH/2gAMAwEAAhEDEQA/AOkfeXz9dv6jJUvb2m95gStJkMu0UDkub2j7zJ0tPafeYChhCNEODEsPaffCEaBoYQhitCNBPKQ2k9slQyOwRQAzue0++DvY3afeYQ8FsEoOiGy5vab3mD2Yh/bb+oyW2DWRohI7MTZ7b/1H6wazF2fxH/qb6wTbW2KMMu9fYqA8BxZsvZUat5SibT+0jUiinMe1acv9C8v8wlIxs7fFLkv1uNt/iP8A1t9YO+Ot/i2f1t9ZW9m43G24dr7OqQ5ZooRvLezbM8tNIlw3TZ9OupBHNq2Of9DfWU8N+gzmo1fFl2faF38Wz+4/1g9m0r/41v8Acf6xdgNr04gZ1PmRqVOjjxU6+fCS2GMooqqatEj7Uv8A41v9x/rIG2riP49392z6yGwwdzGSQaRO+1sR/Hu/u2fWQvtjE/4i/wDvWf8AKDMZCY21eg6iqDV2tif8Rf8A3rP+ULwW08QTrfdw522d3fFSCHYIa+X6ic4o6SVF+B1k6tBA2smraZDM0GI0IRoEhhNbSbQoZWYTUYFWYShisDDazM2CR1mStwiCAdgg1sMsEFtEdDxBLJTelXSc1McPhQLMRlmxP7ukHgbDzY8l8zpxH6e9ORTvYbCsDdwezitPhyazu4Dn2TmVV+QIzY5ksSSSWY8WY8ye2acWFvlhjOG75nwH39HrrnNl9+87cWILHwzzGQ7gMoRsvohncm9YGXeBK7uWeWo58IqW8d4nQeh+HVqN4OGbtz3ihGRAI5ctO49s0eG15mu9HKPyw5/7N/sMNqN1WHdcjkAcjlplnvankeM5EFI4a9x/Qzre3Lj1YUrlmdeBBy009/Oc+21szc/aJ6pOo9knmO6FTSltE1GlyTxeNHpd/cTI2oZSVYcCNGB8ZadibfNhFV2Qf8LcA/d3N85VnXPhoe2Y9YZcD8jyIMaUbPOhkcHwdBsMGtMA2JtI2oVf94mQb8w5N/3nC3aIkejBqStEdjTCCY4mS1rGLG9awzCLr5fSQIIZg118vpFkycmWwPqZOhgQbWT1tMrRIOraEVtAUaEo0VqybVB1bQmtoDW0JqaTAH1GVXGYtmsLbx4nLInQcspZFbQ+EqUvp48tj4l2NcPtsqp6wM2QJzUZuchwy5mcu6U/aLicSGroU4ao5gnP9uw7CRpX4DM98vkqPSLoab7TbVYte8PSUoSC/tZg6Z6cuOsv4ULuhcuNvmJzb7qO0zVsMRwP6RntLZ9uHs6q5d1sswQc1ZfaQ8x8RA7c8sxnprpxy56HnKNLsxNVwwZbmGh+MZbN2g9TCypirD4/lYcx3Tbamy2q3N7Jq7FDVWr6rgjP/K2XFT8YspVg4UAsScgoBJbsyA4mBOv7Hcpl42x0j+8V1MvouD6a9hGeeXapzEis2pSyAMcy43erUFnJPIKPnNtj9CLnG/iGNS5aVqQbD2bzcF8BmfCXXCdGMMuzcNjMPh0W1sPQ9j+lv5NWGdssyCc2OZ45DuAk8rjaPW0+ty4o7aXzev2OZYfo/iX4qKx2ufSy/lXPLzyha9FwNWuYn8qqvzzlpsMFsaNbZBYILyE2F2OlL76u5ORBzKkEHt0hNhktjSDiYxohFRXBlBCUWaVrCEWc2GTN0WGYRdfL6SFFhmEXXy+knLonLoah9T4yZGge9qfGS1vJiDCt4TW0X1vCa2iNUBqxhW0KraL62hVTSckTGNZlWdciR2Ej3SyVNFW2MPuvvDg3z5/WVwSp0UxvmhfPT0hxV/VqXKswHEIN5suZCjVvAZnuM1FRF062cLsK1gGb0jrVP5R+8HgVz8wJzOdBweJF+JXB4TGVsmIsdWqZGa2hSrPe1ZOgGQbJXBAZhy0mnQb7L7rwtmOBpqGWVQJFtmXtHjWn+o/lk1nirsxZ1cuADo1bVds+zD4jeVFsdUuKOa04Op67LcVlZjoWGmnCWjo/0eowoDVjfcjW1sizA+yeCr3D4zp2EwlVNYrrRUrRcgigBQB3Ti2CxWNUW7Urw6psx7GbqU0ZKg26cRXXy19JgMgdTlzk4Z7fK4KY2uL8i5wHG7axNGx1rwq54gYk4JBuh8h1j7notprUE46elC6LldVdCGVgGVhqCpGYIPZlB1xgwz2OVLKdzFBVALG3DLlcFBOrthwSo/8AhOsbPG436FMq4sqmDxDtWOsUpYpZLEOhWxDuuMvEe4ia2tAMBt4YzFY21QVWy0WoDlmFI3NctM8kUnLmTCrWj43aspDlIhsaZrWaDUwmtJQr0SIsJrWaVrCUWTbJmUWG4Ua+UiRIZhE18osuhZdEG/qfGTo8A39T4mTI8Dic0Ma3hVbxbW8JrsitCjOt4XW0WVPC6nk2hZIaVNCHrDrutwPw7DAKXhtLSfTEK/jaOrfqyRnlvDtK55b2XjIHBIORyPI5Z5eXOafats4vgxiqyVtwrdYGU5N1bZLcMxyyyb/JK50I2+2IV67mBtTIg5Ab9Z4HIaZg6HxHbNmKe6PI8ctvayxdHMLiPvdL33VMqF91a6XQlmRkBYtY2WjHQe+dElCU5HMcRLfsraAtX84HpD9R3SGox18yBlj5hd6bysvaCPeMpz/C7Xor6OFrCuVeDbDOhI/fLWaWqI7S/wA850Oce+0TofRhnsxldShzYL0Y7xXrw4fcZc8t1mHAcmPZIQju4JxVle+yba77r4G8Mr1DrK1cEMEbIsuRHIsCO550J0zy7QQQewjUH/vHUTjeytv4vGbbXFPX+0ZwrpWCFWoJ1Z4ngF1zJ4zs02YHcKfkXx8xplO2hsApjLb6alrqsr3eqrXJFYbmRVVGQGSnMaa+MCxlLId1hkeyX6U7bzhrjly//P0lopJUi0FXABUsLqSR1JDK0gbA2bVrCq0mtSQquuI3QrZ6uuGYZdfKaIkLwya+UnJiFY39T4mTJZAGfU+J+clSyVooMq3hVbxXW8JrsitAaGtVkNqeKKrIZTZJtCDel4fS8T02Q+h5KSJtUM7KFtR6nGaurIw7VYFT8DPnDBX24S/NSDbQ71sOAbcYo6nuO6fgeU+jcO84X9pGCFe08Rlpv7ly/wCdAG8fSVpTTv5mvUhl4po6DsjaleJrFtRzB0IPrK3NWHIiMKbSpDKciOBnEMHjLaW363atuBZOBHYynMEeIjSzpXjXGX3jIdqJWp/qA08pqryKx1KrlHbqulqqy1WbnWMCVUOFdgNSQh4zbae1qr62qekOjDIq50+HPv0nzx1zK4tDnrAwcWMSW3hqCSdTOubF20mIoS0aFh6SgElWGjLkNePwykvAhd0HFKM2+CbZuyacPn1SBS3rNxYgcAWOpAz4QtwctDke3LOC4nHbo3gjEdpG6Pjr8Ih2htmxhkPRHd+ssakg7auOWsZLY7N/MMvgJX0BJzPORLmxzMNprgbGbpElKQypJrTXDKq5NsmZqrhVaT1dcKrrk2xDVEhVCazKVwmiuI2K2cyazU+J+clSyQXJqfE/OaBsprNVJoZV2QmuyKUthNdsDQjVDeq2GU2xNXbC6rZNoVqx5RbGFFkQ0XRjh7ZKSJtFgw9k5Z9suDJxlFi8Ww5Hj1dh4+VgnR8NbKX9q1u5ZgrSM1H3ith2q4qP/iYuPiZOotpTdI5bvbw00I5QzZ2CS3R8RVU/JbkKqezK0HLyOXnJ9r7MyIes6HVW5Edh74rW7kwyPfNt2SzYJYZ7ZItuG6B3tr12HA7V3n93CXDozsZcHW1QtNhZusbPIAHIKd1RqBoOJM5KtSjgMvA5fKWX7OQBjWyHGh8/J68pzTDinFSVL9zpjoCCCMwdDKjtvZxrbTVTwMuEhxeHFilT5HsPbONydFMw9cYUVTC4YqxU8QcofRTJyYGzNNUMqrm1VMMqqkmybZpXVCa65LXVCEqk2xXIiSuE01yRKpPXXEbEOTXV6nxPzkD1RpbXqfEyFqptTNSbFbJPK+UOaqQPTGsbcjNd0Lqui1qyJlLMpzRzQ+ovjHD3ytU4iMMPiJOUSbRacLfK79quHZ8JXaOFVwLdyupTP+or74dhcTGyqlqNXYAyOpVlPNWGREj+F2RyRtUch2Tj1A6qzVDwJ/CT8h8pjauyctSM15MOI7jMdJNhWYG3q3zats+pt5OvstyDjmPObbM2uU9Cz0k4dpA7O8d00/8AKP1RbT6iE4+DqPLqXp7P29PQSvg3X1TmO76S1fZnUxxVjsMtynd4Zeu65f7DPWbOSwb1TDXzX6iPvs7we7Xdafx2lQfy1ejp3b2/7pylF9HZdD4Mk/J9ehbZ6enowRftKkbyv2+ifPgf0k1FE3xy51t4Z+Y1Hyh+FpzAPaAfeM5HLxyLMjpphldMnqohVdEzORFsHSmEJVCEpk6UxGxbB0qkyVwhKpIK4u4Vs5RbVqfGRNTGb1amaGqbdxp3CtqZE1EbGmRmiHcg7hO9EGsw8eth5C2GjKQyYhaojhNq7yOMa2YWC24TujWNd9k+FxnfHeBxkqjUMvCT4XGkEA55xZRsVxsv11NGIqavEqr1EZsG5ZfiB4qRyI1nL9rdC7VLPhM7aczuLYQt27yPJWHuPCXjCVM4Bf1eIXt7C3d3RhOhDb5knhi+ziwa+pwgWyuxyEVWUrvMx3QMiMjqZ17ZWBFFNdK8EULn2n8R8zmfOFmYY5DPs1j+4ceNx4uzOc9IcJ6ik8SN4+La/rM4s5Ix7Bn7tYShjGNlW5/KflLBsqjOqsjUbif7RKttO4HJBzyLeHIectnQ64NhlB4oWQ+RzHwImfUfhEy8RD68PCEw83NoHCaNfMfJm5ZMKwJneAgjXyM3Ttp1MNN0066B9dNRbO2h2lXanUzU0xgadTMdRL2V3IXdTPfd4yFEz937odx25Ck4eaHDR1937pkYXunbztwifCSJsF3Sx/dO6bDBTt524qdmzs5pgdmqXJIzC/FuyWzF4YV1vYR6qlvcIowle6gB48T4nUy2KW7kpCV8k0wSJCys/Mqvd6zefIfGYGBr9gHx1PvMsMESLFH0H/lb5GQ5dURkSUJAyOu6TwIPZJ8SM0Yflb5TgmaPVX+UfKbOuYI7QR75HhTmiH8q/ISWcAQ1DLjxzyPiNI76L4zcsdCdHAYfzLoR5g/CLMYm7YexhvDx4H/vfIhYVIccVOflzHuk5q7R0lZe/vU1OIiavFgjPPQ6zb7x3zLsM+1jXr5g3RX182F8G07axh10ylucXddN67ZzidQw6qZFMN6qbimJYtgQpmwoh60yRaILBuABh5IuGh4rAizb/SLC4JOsxFqoD6q6l3PYiDVvKC2+gOQUmFkow4HGck239sVrZjCYdUHJ7yWY+FSEZebGVl+lO18Sc/vNoB9gJSo8Cq5/HOWWGb5fAItze2Kbfsdr6VWKMM4HMovkXUGV+69FU5kBgGbVgMwBwUHiZzXDXXVWB8TjbXOetZssdNfaDHLTjw5Tob5XV6bpDgDMgHd1GZH5hLwi4wdG7FicGo5FX1RJhsUGQD0SclZiNciyg7pPDPu5SSDbOosRjSGzCvmisoG8rHQ58d7MEEHPlC7DmTplrwHCPBtrkpmjGM3t6BdoD9m/hn5jUfKTjUeUGxxJG4ozJyJHD0QddeWfCesvsyOVRz5ekpHzlCdcGdn/ALsDmCVPkSPllCYtwNroG6xX1bezC58ePCGVYpG0DDPsOh9xnHMh2nVmu8OKnPy/EP18oADHcS2VbjFOXFf5T9IskAzh7yvo+Y8ISuIgNqZjTiOEHW+I43yBqx0L5sL4pW+SrfE2sXaNOuklNusVC6EYe3Xyga4AdIFU33BNGtkT2zHRmCC4Eie6DPbBcViwis7HJVBZj2ADMmFRGoSdPumYwFQCgPfZmKkPAAcbHy13R2czp2kcNxeJuxNxssZrbn4sdcuxVHBQOwZASXbe1nxV9mJfPOw+gp/BWNK07shqe8k8472Ds8VoGI9Nhn4A65fqf/U2pLFG/MfSaaWry7Fwl2/b7kOC2NXWN+7Inic/VH/IyLH7XPqp6I+J+gmu1cZvscvVXPLv7TE1raE9xlY4/wA0uzZqtTHTrwtOqXr5v6jfozs0Yq1jZrVXkWHDfY55L4aEny7Z0vZeHCorD0c9chooHIBeGglE6FWha7l59YD5FFA+Rluwe2a0QK2eY00y4cuJnLluzNgXy35seMxJzOp7TxmIuTbFZ4BvcPrJ12hWeZHiCPjCWoIRAOHPj2nxM2mtdit6pB8DnNoQHppbSraMAfH9Dym8ixF4QZnyHMnsE45EeFJDMmZIXdIJ4gHPQnnwmNoUby5j1l1HeOYmcIAASWBZjm2RHkPISY2qPxD3icF9iZTmM4JjavxDzhG02CtnWwIOpA1yPOKr7nPOKlycbJdJluirMiS13TnE6hqtsJw1mvl9IoS2FYS3XyitcCtcHV3skL2yJ7JA9sw0ZyV7ZVvtExZXZ2Jy/Eip5WOqN8GMePbK901pNuCxCAZnqywHMmsiwD/TKRVMDTp0cgw6A2IvLeHxIH6y7XnJWy9k5e6UauzJlYeI8iCJearA6hhwYZ+Rl9Rw0z1vgTTWSPnx/wClUYZjKBMMwRGmMw5rYqeHI9ogN1fMTY6atHl6vDJPntdm2ycf1L7/AOBgFfuy4N5a+8yzI2+cwcxyI4SnnTwPwhOz8e9J9DJkPFCdP8p5H4STRLBn2cPov2DSP8Csq2w9sU3EKrbr/wANtG8va8pbMHITNW5S5Qyr2dU/rIM+0ei3vGsmfo/Zxptz/Jbr7nXX3gyTBx1hGkHklHpk3OSKudm4rPLqgv5mdSvkF1M3GyFXV/2jHiWAyHcq8AJb71zGcVYmud40pHeI2VfEbPr9hf6RAbcIo/CPcJYsRXF19UpGTGUhFdTA7KY7uqgV1UomUTsT2VQZ6o3tqg1lcdMZOhfvEQrBWa+X6iavVPYWv0vL9RC+jm1R0+x5A9k0tfjB7LJkSM6ibWWQa15iyyC2WR0hjlG3tmnDXvUB6Oe/UeRQ55L5ar5QvYe1AnoP6p4H2TzB7vlLd0l2WuJryzydda27DzB/Kefl2TnNisrFSMmU5Mp4593/AHWXVSjTJQyT02VZIfz2LxiKFcZMMxyPZ3gxLitmOuq+kO7j5j6QHZ21Xr0HpL7J5eB5R/hNrVP+LdPY2nuPAya8TF1yj3oanS61fN8sv59H/krj0g9xg74Y8vh9Jc78Mj+soPfz98Ct2Op9ViPHUSi1EH3wZ83waXcef2/0VSxDwYA/AxtsvpNisPkFsLqPwWguPJh6Q98Ls2O/IqfeIPZsuwfg92X6GM3CXmjz5fDs8Ok/5/YtuyvtOq0GIpev81ZFi+JByYeGRl22P012fdluYqoHkrt1Te6zKcVbZ7ew48jInwfaD5j/ANSb06l0yTw5l2j6eqcOuakMO0EEe8QPEJPmqjDdWc62as8yhKH3qQY0w+28ami43E/5rGf/AHkyf9JJdMChkX5Tt99cX3VzlS9Jtpf4u0+NdR/8Jriek20AN5sS4HaaqhqeXqcYVgmux1Ga5o6RdXA7a4i6P7M2hdlbisRclfFavRSxh+fdUbg7uPhLRZXAGLbFNlcFsrjWyuDWVxkyiYreuYw6el5fSGPXNaK/S8vpHsYtFr6nxg7vMWvBneRSJnrHg9jz1jwax4yQUjWx4g27stb/AEh6Ng4N2j2W7R8o2seCWvKIaUVJUyiW0srFXBRx8R2jkwmN4jiPMS07QwyWjdYZ9h5g9oMQYrZ9lWuRdPaA1H8w/WUTMWXTyjyuUYw2NsT1HIHZnmPcdIxp2+49ZVbwzU/qIlAB1HvE8cx3+OnynOEX2g4tZnxfgm1/j9HwWirb1R9YMvlmPhC6toVNwsXzOR9xlMFg7/mPhNgw7ZJ6eD6PQx/HNRH8ST/b+foXoHsmZRkYrwJHgcvlCa9pXLwsbz9L5xHpn5M2Q+PQ/PB/R39i4Zz2crFe3bhx3W8Vy+REsXRbBYzaJyorFdYOT4lsyi5cRWp/eP3Z5DmZOWKUVbNUfjOma8/0MPcxdaqka25vVqXjl7THgiDmxlu2B0OFRF+KItxA1UD91T3VA8W/OdezKWfYPRqjBIVqBLNkbLXO9bYe12+QGQHIQq5ZPd6HkarWz1D54j6fcV3JA7UjO1IJakZMzJiy1IK6RlYkGsSUTHF1lc0pTXyhbpNK018o18BvgmtbUwex5tc+p8YM7zkrOSNbHg1jzaxoNY8oOaWNBLWklrQWwx0qDFGo1MLqWQVLC6lnMaTAMb0drt9Jf2b9q+qf5l4HyyiHHbJvp1dCy+2mbL5jivnL1UIbSIm6jNPDGXJyU1htVPuk1VaHSxrFPtBFtXzGasPjOlY/oxhrySybre3WdxvPLRvMGV/G9A8QuZosW0ey/wCzfwB1U/CHfF+xllhkivJs1W/d4rDHuax8O3hu2qB8ZOnR3Gt6lJfs6u3DW5+ARyTHGyOgOKuP7fdw6c8ytlh/lCkqPEnyM6X0a6MYXBj9jWN4+tY3pWN4seA7hkO6Tnl29OwRx32io9EPsyZ8rcf6K55jDqfSP/3OvAflU+J5TsGBpStFrrVURQAqqAFAHAADgIFUYdUZkyTcuym1R6M3LArVjGwQOxYsQoXWrBbFjC1YLasdOhxdYkGdYwsWDWLKJjxYvsSR1Lr5Qx1kaJrHvgYUXWDM6wZ7B2zqpnjEWf2E8X2OQ2WDtg72DtHvnZDMQrP7DeJ7HErLR2iQhwTxE7nMCN/U+wVnryOK1EdohlWU6/MiB6j2A81+RyqnKG05TpQm0V5r8hfF9jn9JhtRl0E2iPL7A3lWpMNpMerNhFcrFchbS0MqMIWbCI2LdnhqIPaIUJgwXQBZasEsEezSMpDbiuOsGsWWuYMbeGymusirGsus9D4g28//2Q=="
      class="w-12 h-12 rounded-full shadow"
    />
    <div class="bg-[#00000011] p-4 pr-6 m-3 rounded-md hover:cursor-pointer hover:bg-[#00000025]">
      <div class="text-sm opacity-50"><%= event.sender %></div>
      <div class="text-lg"><%= event.payload %></div>
      <%!-- <div class="text-sm opacity-50"><%= event.inserted_at %></div> --%>
    </div>
  </div>
</div>

<.simple_form
  for={@msg_input}
  phx-submit="send"
  inner_class="flex justify-center items-center gap-2 min-w-[300px]"
>
  <.input
    field={@msg_input[:content]}
    placeholder="Send a message..."
    label="content"
    name="content"
  />
  <:actions>
    <.button>Send</.button>
  </:actions>
</.simple_form>

<div :for={{id, room} <- @streams.rooms} id={id} phx-update="stream" class="bg-black h-3">
  <%= room %>
</div>
